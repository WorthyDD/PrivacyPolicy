<!DOCTYPE html>
<!-- saved from url=(0079)https://sekaiapp-prod-data.s3.us-east-1.amazonaws.com/v3-games/dist/pgc/27.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StatMatch - Sports Statistics Comparison</title>
    <script src="./StatMatch - Sports Statistics Comparison_files/saved_resource"></script><script src="chrome-extension://idnnbdplmphpflfnlkomgpfbpcgelopg/inpage.js" id="xverse-wallet-provider" data-is-priority="true"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <link href="./StatMatch - Sports Statistics Comparison_files/css2" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overscroll-behavior: none;
        }

        /* Configure custom Tailwind colors */
        @layer base {
            :root {
                --color-stat-dark: #0f172a;
                --color-stat-card: #1e293b;
                --color-stat-accent: #3b82f6;
                --color-stat-success: #10b981;
                --color-stat-danger: #ef4444;
                --color-stat-warning: #f59e0b;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a;
        }
        ::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }

        /* Fade-in animation */
        @keyframes fade-in {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fade-in 0.4s ease-out;
        }

        /* Spinner animation */
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        /* Pulse animation for loading */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }

        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        /* Progress bar transitions */
        .progress-bar-transition {
            transition: width 1s ease-out;
        }

        /* Background clip for gradient text */
        .bg-clip-text {
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Keyboard fix styles */
        html {
            background-color: #0f172a; /* Match bg-stat-dark */
        }
        body.keyboard-open {
            overflow-y: auto !important;
            min-height: 100vh;
        }
        body.keyboard-open nav {
            display: none !important;
        }
        body.keyboard-open .pb-24 {
            padding-bottom: 1rem !important;
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.bottom-0{bottom:0px}.left-0{left:0px}.left-3{left:0.75rem}.right-0{right:0px}.top-3{top:0.75rem}.z-10{z-index:10}.z-50{z-index:50}.-my-2{margin-top:-0.5rem;margin-bottom:-0.5rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mt-2{margin-top:0.5rem}.flex{display:flex}.h-16{height:4rem}.h-4{height:1rem}.h-6{height:1.5rem}.min-h-screen{min-height:100vh}.w-4{width:1rem}.w-6{width:1.5rem}.w-full{width:100%}.max-w-lg{max-width:32rem}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.justify-around{justify-content:space-around}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.overflow-x-auto{overflow-x:auto}.whitespace-nowrap{white-space:nowrap}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-4{border-width:4px}.border-t{border-top-width:1px}.border-gray-600{--tw-border-opacity:1;border-color:rgb(75 85 99 / var(--tw-border-opacity, 1))}.border-gray-700{--tw-border-opacity:1;border-color:rgb(55 65 81 / var(--tw-border-opacity, 1))}.border-stat-card{--tw-border-opacity:1;border-color:rgb(30 41 59 / var(--tw-border-opacity, 1))}.bg-stat-dark{--tw-bg-opacity:1;background-color:rgb(15 23 42 / var(--tw-bg-opacity, 1))}.bg-gray-600{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.bg-stat-accent{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.bg-stat-card{--tw-bg-opacity:1;background-color:rgb(30 41 59 / var(--tw-bg-opacity, 1))}.p-1{padding:0.25rem}.p-4{padding:1rem}.px-1{padding-left:0.25rem;padding-right:0.25rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.pb-24{padding-bottom:6rem}.pl-10{padding-left:2.5rem}.pr-4{padding-right:1rem}.pt-2{padding-top:0.5rem}.text-center{text-align:center}.font-sans{font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"}.text-2xl{font-size:1.5rem;line-height:2rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.tracking-tight{letter-spacing:-0.025em}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-stat-accent{--tw-text-opacity:1;color:rgb(59 130 246 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-blue-900\/20{--tw-shadow-color:rgb(30 58 138 / 0.2);--tw-shadow:var(--tw-shadow-colored)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-200{transition-duration:200ms}.selection\:bg-stat-accent *::selection{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.selection\:text-white *::selection{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.selection\:bg-stat-accent::selection{--tw-bg-opacity:1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1))}.selection\:text-white::selection{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.hover\:bg-blue-600:hover{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.hover\:text-gray-200:hover{--tw-text-opacity:1;color:rgb(229 231 235 / var(--tw-text-opacity, 1))}.focus\:border-stat-accent:focus{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:opacity-50:disabled{opacity:0.5}</style></head>
<body class="bg-stat-dark">
    <div id="app">
                <div class="min-h-screen bg-stat-dark text-gray-100 font-sans selection:bg-stat-accent selection:text-white">
                    <main class="w-full min-h-screen">
                        
                <div class="p-4 pb-24 max-w-lg mx-auto">
                    <!-- Header -->
                    <h1 class="text-2xl font-bold text-white mb-6 text-center tracking-tight">
                        <span class="text-stat-accent">Stat</span>Match
                    </h1>

                    <!-- Inputs -->
                    <div class="bg-stat-card p-4 rounded-xl shadow-lg border border-gray-700 mb-6">
                        <div class="flex gap-2 mb-4 overflow-x-auto">
                            
                                <button data-action="select-sport" data-sport="Basketball" class="px-3 py-1 rounded-full text-xs font-semibold transition-all whitespace-nowrap bg-stat-accent text-white">
                                    Basketball
                                </button>
                            
                                <button data-action="select-sport" data-sport="Football" class="px-3 py-1 rounded-full text-xs font-semibold transition-all whitespace-nowrap bg-gray-700 text-gray-300">
                                    Football
                                </button>
                            
                                <button data-action="select-sport" data-sport="Baseball" class="px-3 py-1 rounded-full text-xs font-semibold transition-all whitespace-nowrap bg-gray-700 text-gray-300">
                                    Baseball
                                </button>
                            
                                <button data-action="select-sport" data-sport="Soccer" class="px-3 py-1 rounded-full text-xs font-semibold transition-all whitespace-nowrap bg-gray-700 text-gray-300">
                                    Soccer
                                </button>
                            
                        </div>

                        <div class="flex flex-col gap-3">
                            <div class="relative">
                                <div class="absolute left-3 top-3 text-gray-400"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div>
                                <input type="text" id="compare-p1" placeholder="Player A (e.g. LeBron)" value="" class="w-full bg-stat-dark border border-gray-600 rounded-lg py-2 pl-10 pr-4 text-white focus:outline-none focus:border-stat-accent transition-colors">
                            </div>
                            <div class="flex justify-center -my-2 z-10">
                                <div class="bg-gray-600 rounded-full p-1 border-4 border-stat-card">
                                    <span class="text-xs font-bold text-white px-1">VS</span>
                                </div>
                            </div>
                            <div class="relative">
                                <div class="absolute left-3 top-3 text-gray-400"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></div>
                                <input type="text" id="compare-p2" placeholder="Player B (e.g. Jordan)" value="" class="w-full bg-stat-dark border border-gray-600 rounded-lg py-2 pl-10 pr-4 text-white focus:outline-none focus:border-stat-accent transition-colors">
                            </div>

                            <button data-action="compare-fight" class="mt-2 w-full bg-stat-accent hover:bg-blue-600 text-white font-bold py-3 rounded-lg transition-all shadow-lg shadow-blue-900/20 flex justify-center items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed">
                                
                                    FIGHT <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                                
                            </button>
                        </div>
                    </div>

                    

                    
                </div>
            
                    </main>
                    
                <nav class="fixed bottom-0 left-0 right-0 bg-stat-card border-t border-gray-700 pb-safe pt-2 px-4 shadow-lg z-50">
                    <div class="flex justify-around items-center max-w-lg mx-auto h-16">
                        
                                <button data-action="nav-tab" data-tab="compare" class="flex flex-col items-center justify-center w-full transition-colors duration-200 text-stat-accent">
                                    <div class="mb-1"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"></path></svg></div>
                                    <span class="text-xs font-medium">Compare</span>
                                </button>
                            
                                <button data-action="nav-tab" data-tab="debate" class="flex flex-col items-center justify-center w-full transition-colors duration-200 text-gray-400 hover:text-gray-200">
                                    <div class="mb-1"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path></svg></div>
                                    <span class="text-xs font-medium">Debate</span>
                                </button>
                            
                                <button data-action="nav-tab" data-tab="fantasy" class="flex flex-col items-center justify-center w-full transition-colors duration-200 text-gray-400 hover:text-gray-200">
                                    <div class="mb-1"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg></div>
                                    <span class="text-xs font-medium">Fantasy</span>
                                </button>
                            
                    </div>
                </nav>
            
                </div>
            </div>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'stat-dark': '#0f172a',
                        'stat-card': '#1e293b',
                        'stat-accent': '#3b82f6',
                        'stat-success': '#10b981',
                        'stat-danger': '#ef4444',
                        'stat-warning': '#f59e0b',
                    }
                }
            }
        };

        // ============================================
        // CONSTANTS & ENUMS
        // ============================================
        const ViewType = {
            COMPARE: 'compare',
            DEBATE: 'debate',
            FANTASY: 'fantasy'
        };

        const FantasyRecommendation = {
            START: 'START',
            SIT: 'SIT',
            DROP: 'DROP',
            ADD: 'ADD'
        };

        // ============================================
        // CENTRAL STATE
        // ============================================
        const state = {
            activeTab: ViewType.COMPARE,

            // CompareView state
            compare: {
                p1: '',
                p2: '',
                sport: 'Basketball',
                data: null,
                loading: false,
                error: ''
            },

            // DebateView state
            debate: {
                topic: '',
                candidates: '',
                criteria: '',
                result: null,
                loading: false
            },

            // FantasyView state
            fantasy: {
                player: '',
                context: '',
                advice: null,
                loading: false
            },

            // AI callback tracking
            pendingAICallbacks: new Map()
        };

        // ============================================
        // SEKAI IFRAME MESSAGE API
        // ============================================
        let taskIdCounter = 0;

        function callLLM(systemPrompt, userPrompt, responseSchema, callback) {
            const taskId = `llm-${Date.now()}-${taskIdCounter++}`;

            // Store callback for this message
            state.pendingAICallbacks.set(taskId, callback);

            // Send message to parent
            window.parent.postMessage({
                origin: 'sekai_gaming_iframe_api',
                type: 'call_llm',
                taskId: taskId,
                data: {
                    systemPrompt: systemPrompt,
                    userPrompt: userPrompt,
                    responseSchema: responseSchema
                }
            }, '*');
        }

        // Listen for responses
        window.addEventListener('message', (event) => {
            if (event.data.origin === 'sekai_gaming_iframe_api' && event.data.type === 'receive_call_llm') {
                const { taskId, data } = event.data;
                const callback = state.pendingAICallbacks.get(taskId);

                if (callback) {
                    callback(data);
                    state.pendingAICallbacks.delete(taskId);
                }
            }
        });

        // ============================================
        // AI SERVICE FUNCTIONS
        // ============================================
        function comparePlayers(p1Name, p2Name, sport, callback) {
            const systemPrompt = `You are an expert sports statistician and analyst. Provide accurate and realistic statistics for players in ${sport}.`;

            const userPrompt = `Compare ${p1Name} and ${p2Name} in ${sport}.
Provide their current or most recent season stats.
Identify which stats are 'better' (e.g., higher points is better, lower ERA is better).
Provide a 'recentForm' array representing their performance score (e.g., Game Score, Fantasy Points) in their last 5 games.
Provide a short, punchy analysis text and a final verdict.`;

            const responseSchema = {
                type: 'object',
                properties: {
                    comparison: {
                        type: 'object',
                        properties: {
                            player1: {
                                type: 'object',
                                properties: {
                                    name: { type: 'string' },
                                    team: { type: 'string' },
                                    sport: { type: 'string' },
                                    position: { type: 'string' },
                                    stats: {
                                        type: 'array',
                                        items: {
                                            type: 'object',
                                            properties: {
                                                label: { type: 'string', description: 'Stat name like PPG, APG, etc.' },
                                                value: { type: 'number', description: 'The numeric value' },
                                                unit: { type: 'string', description: 'Unit like pts, assists, etc.' },
                                                better: { type: 'boolean', description: 'True if this player has the better stat' }
                                            },
                                            required: ['label', 'value', 'better']
                                        }
                                    },
                                    recentForm: {
                                        type: 'array',
                                        items: {
                                            type: 'object',
                                            properties: {
                                                game: { type: 'string', description: 'Game identifier like G1, G2, etc.' },
                                                score: { type: 'number', description: 'Performance score for that game' }
                                            },
                                            required: ['game', 'score']
                                        }
                                    }
                                },
                                required: ['name', 'team', 'sport', 'position', 'stats', 'recentForm']
                            },
                            player2: {
                                type: 'object',
                                properties: {
                                    name: { type: 'string' },
                                    team: { type: 'string' },
                                    sport: { type: 'string' },
                                    position: { type: 'string' },
                                    stats: {
                                        type: 'array',
                                        items: {
                                            type: 'object',
                                            properties: {
                                                label: { type: 'string' },
                                                value: { type: 'number' },
                                                unit: { type: 'string' },
                                                better: { type: 'boolean' }
                                            },
                                            required: ['label', 'value', 'better']
                                        }
                                    },
                                    recentForm: {
                                        type: 'array',
                                        items: {
                                            type: 'object',
                                            properties: {
                                                game: { type: 'string' },
                                                score: { type: 'number' }
                                            },
                                            required: ['game', 'score']
                                        }
                                    }
                                },
                                required: ['name', 'team', 'sport', 'position', 'stats', 'recentForm']
                            },
                            analysis: { type: 'string', description: 'Short analysis of the comparison' },
                            verdict: { type: 'string', description: 'Final verdict like "Player A wins" or "Too close to call"' }
                        },
                        required: ['player1', 'player2', 'analysis', 'verdict']
                    }
                },
                required: ['comparison'],
                additionalProperties: false
            };

            callLLM(systemPrompt, userPrompt, responseSchema, (data) => {
                callback(data.comparison);
            });
        }

        function runDebate(topic, candidates, criteria, callback) {
            const systemPrompt = `You are an impartial sports debate judge. Analyze candidates objectively based on the given criteria.`;

            const userPrompt = `Conduct a sports debate. Topic: "${topic}". Candidates: ${candidates.join(', ')}.
Criteria/Weighting focus: ${criteria}.
Assign a score (0-100) to each candidate based strictly on the criteria.
Provide a short reasoning for each.`;

            const responseSchema = {
                type: 'object',
                properties: {
                    debate: {
                        type: 'object',
                        properties: {
                            topic: { type: 'string', description: 'The debate topic' },
                            winningCriteria: { type: 'string', description: 'Summary of the judging criteria used' },
                            candidates: {
                                type: 'array',
                                items: {
                                    type: 'object',
                                    properties: {
                                        name: { type: 'string', description: 'Candidate name' },
                                        score: { type: 'number', description: 'Score from 0-100' },
                                        reasoning: { type: 'string', description: 'Short reasoning for the score' }
                                    },
                                    required: ['name', 'score', 'reasoning']
                                }
                            }
                        },
                        required: ['topic', 'winningCriteria', 'candidates']
                    }
                },
                required: ['debate'],
                additionalProperties: false
            };

            callLLM(systemPrompt, userPrompt, responseSchema, (data) => {
                callback(data.debate);
            });
        }

        function getFantasyAdvice(player, context, callback) {
            const systemPrompt = `You are a fantasy sports expert. Provide actionable advice for fantasy lineup decisions.`;

            const userPrompt = `Provide fantasy sports advice for ${player}. Context/League Settings: ${context}.
Analyze recent form, matchup difficulty, and injury status.
Return a recommendation (START, SIT, DROP, ADD).
Provide a confidence score (0-100) and a matchup grade (A+ to F).`;

            const responseSchema = {
                type: 'object',
                properties: {
                    advice: {
                        type: 'object',
                        properties: {
                            recommendation: {
                                type: 'string',
                                enum: ['START', 'SIT', 'DROP', 'ADD'],
                                description: 'The fantasy lineup recommendation'
                            },
                            confidenceScore: {
                                type: 'integer',
                                description: 'Confidence level from 0-100'
                            },
                            reasoning: {
                                type: 'string',
                                description: 'Detailed reasoning for the recommendation'
                            },
                            matchupGrade: {
                                type: 'string',
                                description: 'Matchup difficulty grade from A+ to F'
                            }
                        },
                        required: ['recommendation', 'confidenceScore', 'reasoning', 'matchupGrade']
                    }
                },
                required: ['advice'],
                additionalProperties: false
            };

            callLLM(systemPrompt, userPrompt, responseSchema, (data) => {
                callback(data.advice);
            });
        }

        // ============================================
        // SVG ICON LIBRARY
        // ============================================
        const icons = {
            search: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>`,
            arrowRight: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/></svg>`,
            share: `<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/></svg>`,
            trophy: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/></svg>`,
            messageSquare: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/></svg>`,
            award: `<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
            activity: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"/></svg>`,
            checkCircle: `<svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
            xCircle: `<svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
            alertTriangle: `<svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/></svg>`,
            plusCircle: `<svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>`,
            scale: `<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"/></svg>`
        };

        // ============================================
        // RENDER FUNCTIONS
        // ============================================
        function render() {
            const app = document.getElementById('app');
            app.innerHTML = `
                <div class="min-h-screen bg-stat-dark text-gray-100 font-sans selection:bg-stat-accent selection:text-white">
                    <main class="w-full min-h-screen">
                        ${renderActiveView()}
                    </main>
                    ${renderNavbar()}
                </div>
            `;

            // Reattach event listeners
            attachEventListeners();
        }

        function renderActiveView() {
            switch(state.activeTab) {
                case ViewType.COMPARE:
                    return renderCompareView();
                case ViewType.DEBATE:
                    return renderDebateView();
                case ViewType.FANTASY:
                    return renderFantasyView();
                default:
                    return renderCompareView();
            }
        }

        function renderCompareView() {
            const { p1, p2, sport, data, loading, error } = state.compare;

            return `
                <div class="p-4 pb-24 max-w-lg mx-auto">
                    <!-- Header -->
                    <h1 class="text-2xl font-bold text-white mb-6 text-center tracking-tight">
                        <span class="text-stat-accent">Stat</span>Match
                    </h1>

                    <!-- Inputs -->
                    <div class="bg-stat-card p-4 rounded-xl shadow-lg border border-gray-700 mb-6">
                        <div class="flex gap-2 mb-4 overflow-x-auto">
                            ${['Basketball', 'Football', 'Baseball', 'Soccer'].map(s => `
                                <button
                                    data-action="select-sport" data-sport="${s}"
                                    class="px-3 py-1 rounded-full text-xs font-semibold transition-all whitespace-nowrap ${sport === s ? 'bg-stat-accent text-white' : 'bg-gray-700 text-gray-300'}"
                                >
                                    ${s}
                                </button>
                            `).join('')}
                        </div>

                        <div class="flex flex-col gap-3">
                            <div class="relative">
                                <div class="absolute left-3 top-3 text-gray-400">${icons.search}</div>
                                <input
                                    type="text"
                                    id="compare-p1"
                                    placeholder="Player A (e.g. LeBron)"
                                    value="${p1}"
                                    class="w-full bg-stat-dark border border-gray-600 rounded-lg py-2 pl-10 pr-4 text-white focus:outline-none focus:border-stat-accent transition-colors"
                                />
                            </div>
                            <div class="flex justify-center -my-2 z-10">
                                <div class="bg-gray-600 rounded-full p-1 border-4 border-stat-card">
                                    <span class="text-xs font-bold text-white px-1">VS</span>
                                </div>
                            </div>
                            <div class="relative">
                                <div class="absolute left-3 top-3 text-gray-400">${icons.search}</div>
                                <input
                                    type="text"
                                    id="compare-p2"
                                    placeholder="Player B (e.g. Jordan)"
                                    value="${p2}"
                                    class="w-full bg-stat-dark border border-gray-600 rounded-lg py-2 pl-10 pr-4 text-white focus:outline-none focus:border-stat-accent transition-colors"
                                />
                            </div>

                            <button
                                data-action="compare-fight"
                                ${loading ? 'disabled' : ''}
                                class="mt-2 w-full bg-stat-accent hover:bg-blue-600 text-white font-bold py-3 rounded-lg transition-all shadow-lg shadow-blue-900/20 flex justify-center items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                ${loading ? `
                                    <div class="w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                                ` : `
                                    FIGHT ${icons.arrowRight}
                                `}
                            </button>
                        </div>
                    </div>

                    ${error ? `
                        <div class="bg-red-900/50 border border-red-700 text-red-200 p-4 rounded-lg mb-6 text-center">
                            ${error}
                        </div>
                    ` : ''}

                    ${data ? renderCompareResults(data) : ''}
                </div>
            `;
        }

        function renderCompareResults(data) {
            return `
                <div class="space-y-6 animate-fade-in">
                    <!-- Head to Head Header -->
                    <div class="flex justify-between items-center bg-stat-card p-4 rounded-xl border border-gray-700">
                        <div class="text-center w-1/2 border-r border-gray-700 pr-2">
                            <h2 class="text-lg font-bold text-white leading-tight">${data.player1.name}</h2>
                            <p class="text-xs text-gray-400">${data.player1.team}</p>
                        </div>
                        <div class="text-center w-1/2 pl-2">
                            <h2 class="text-lg font-bold text-white leading-tight">${data.player2.name}</h2>
                            <p class="text-xs text-gray-400">${data.player2.team}</p>
                        </div>
                    </div>

                    <!-- Stat Grid -->
                    <div class="space-y-2">
                        ${data.player1.stats.map((stat, idx) => {
                            const p2Stat = data.player2.stats[idx];
                            if (!p2Stat) return '';

                            return `
                                <div class="bg-stat-card rounded-lg p-3 flex items-center justify-between border border-gray-800 relative overflow-hidden">
                                    <div class="text-lg font-mono font-bold w-16 text-left z-10 ${stat.better ? 'text-stat-success' : 'text-stat-danger'}">
                                        ${stat.value}
                                    </div>

                                    <div class="flex flex-col items-center z-10">
                                        <span class="text-xs uppercase tracking-wider text-gray-400 font-semibold">${stat.label}</span>
                                    </div>

                                    <div class="text-lg font-mono font-bold w-16 text-right z-10 ${p2Stat.better ? 'text-stat-success' : 'text-stat-danger'}">
                                        ${p2Stat.value}
                                    </div>

                                    <!-- Visual Bar Background Comparison -->
                                    <div class="absolute bottom-0 left-0 h-1 bg-stat-success opacity-20" style="width: ${stat.better ? '50%' : '0%'}"></div>
                                    <div class="absolute bottom-0 right-0 h-1 bg-stat-success opacity-20" style="width: ${p2Stat.better ? '50%' : '0%'}"></div>
                                </div>
                            `;
                        }).join('')}
                    </div>

                    <!-- Recent Form Chart -->
                    ${renderRecentFormChart(data)}

                    <!-- Analysis -->
                    <div class="bg-gradient-to-br from-gray-800 to-gray-900 p-5 rounded-xl border border-gray-700">
                        <div class="flex items-center gap-2 mb-2">
                            ${icons.trophy}
                            <h3 class="font-bold text-white">The Verdict</h3>
                        </div>
                        <p class="text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500 mb-3">
                            ${data.verdict}
                        </p>
                        <p class="text-gray-300 text-sm leading-relaxed">
                            ${data.analysis}
                        </p>
                        <button class="mt-4 w-full py-2 flex items-center justify-center gap-2 text-sm font-medium text-gray-400 hover:text-white border border-gray-600 rounded-lg hover:bg-gray-700 transition-colors">
                            ${icons.share} Share Receipt
                        </button>
                    </div>
                </div>
            `;
        }

        function renderRecentFormChart(data) {
            if (!data.player1.recentForm || !data.player2.recentForm) return '';

            const p1Form = data.player1.recentForm;
            const p2Form = data.player2.recentForm;

            // Find min and max for scaling
            const allScores = [...p1Form.map(f => f.score), ...p2Form.map(f => f.score)];
            const minScore = Math.min(...allScores);
            const maxScore = Math.max(...allScores);
            const range = maxScore - minScore || 1;

            // SVG dimensions
            const width = 400;
            const height = 180;
            const padding = { top: 20, right: 20, bottom: 30, left: 40 };
            const chartWidth = width - padding.left - padding.right;
            const chartHeight = height - padding.top - padding.bottom;

            // Calculate points for line chart
            const pointsP1 = p1Form.map((item, idx) => {
                const x = padding.left + (chartWidth / (p1Form.length - 1)) * idx;
                const y = padding.top + chartHeight - ((item.score - minScore) / range) * chartHeight;
                return `${x},${y}`;
            }).join(' ');

            const pointsP2 = p2Form.map((item, idx) => {
                const x = padding.left + (chartWidth / (p2Form.length - 1)) * idx;
                const y = padding.top + chartHeight - ((item.score - minScore) / range) * chartHeight;
                return `${x},${y}`;
            }).join(' ');

            return `
                <div class="bg-stat-card p-4 rounded-xl border border-gray-700">
                    <h3 class="text-sm font-semibold text-gray-300 mb-4">Recent Form (Last 5 Games)</h3>
                    <div class="w-full" style="height: 180px;">
                        <svg viewBox="0 0 ${width} ${height}" class="w-full h-full">
                            <!-- Grid lines -->
                            ${[0, 1, 2, 3, 4].map(i => {
                                const y = padding.top + (chartHeight / 4) * i;
                                return `<line x1="${padding.left}" y1="${y}" x2="${width - padding.right}" y2="${y}" stroke="#374151" stroke-dasharray="3,3" stroke-width="1"/>`;
                            }).join('')}

                            <!-- Player 1 line (blue) -->
                            <polyline
                                points="${pointsP1}"
                                fill="none"
                                stroke="#3b82f6"
                                stroke-width="3"
                            />
                            ${p1Form.map((item, idx) => {
                                const x = padding.left + (chartWidth / (p1Form.length - 1)) * idx;
                                const y = padding.top + chartHeight - ((item.score - minScore) / range) * chartHeight;
                                return `<circle cx="${x}" cy="${y}" r="4" fill="#3b82f6"/>`;
                            }).join('')}

                            <!-- Player 2 line (green) -->
                            <polyline
                                points="${pointsP2}"
                                fill="none"
                                stroke="#10b981"
                                stroke-width="3"
                            />
                            ${p2Form.map((item, idx) => {
                                const x = padding.left + (chartWidth / (p2Form.length - 1)) * idx;
                                const y = padding.top + chartHeight - ((item.score - minScore) / range) * chartHeight;
                                return `<circle cx="${x}" cy="${y}" r="4" fill="#10b981"/>`;
                            }).join('')}

                            <!-- X-axis labels -->
                            ${p1Form.map((item, idx) => {
                                const x = padding.left + (chartWidth / (p1Form.length - 1)) * idx;
                                const y = height - padding.bottom + 15;
                                return `<text x="${x}" y="${y}" fill="#9ca3af" font-size="10" text-anchor="middle">${item.game.split(' ')[0]}</text>`;
                            }).join('')}

                            <!-- Legend -->
                            <text x="${padding.left}" y="15" fill="#3b82f6" font-size="10">${data.player1.name}</text>
                            <text x="${padding.left + 100}" y="15" fill="#10b981" font-size="10">${data.player2.name}</text>
                        </svg>
                    </div>
                </div>
            `;
        }

        function renderDebateView() {
            const { topic, candidates, criteria, result, loading } = state.debate;

            return `
                <div class="p-4 pb-24 max-w-lg mx-auto">
                    <h1 class="text-2xl font-bold text-white mb-2 text-center">The Arena</h1>
                    <p class="text-gray-400 text-center text-sm mb-6">Settle the argument once and for all.</p>

                    <div class="bg-stat-card p-5 rounded-xl border border-gray-700 shadow-lg space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-gray-400 uppercase mb-1">Debate Topic</label>
                            <input
                                type="text"
                                id="debate-topic"
                                value="${topic}"
                                placeholder="e.g. 2024 NBA MVP"
                                class="w-full bg-stat-dark border border-gray-600 rounded-lg py-2 px-3 text-white text-sm focus:border-stat-warning outline-none"
                            />
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-400 uppercase mb-1">Candidates (comma separated)</label>
                            <input
                                type="text"
                                id="debate-candidates"
                                value="${candidates}"
                                placeholder="Jokic, SGA, Luka"
                                class="w-full bg-stat-dark border border-gray-600 rounded-lg py-2 px-3 text-white text-sm focus:border-stat-warning outline-none"
                            />
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-400 uppercase mb-1">Weighting Criteria (Optional)</label>
                            <input
                                type="text"
                                id="debate-criteria"
                                value="${criteria}"
                                placeholder="e.g. Focus on efficiency and defense"
                                class="w-full bg-stat-dark border border-gray-600 rounded-lg py-2 px-3 text-white text-sm focus:border-stat-warning outline-none"
                            />
                        </div>

                        <button
                            data-action="debate-start"
                            ${loading ? 'disabled' : ''}
                            class="w-full bg-stat-warning hover:bg-orange-600 text-white font-bold py-3 rounded-lg mt-2 shadow-lg shadow-orange-900/20 transition-all disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            ${loading ? 'Calculating...' : 'Start Debate'}
                        </button>
                    </div>

                    ${result ? renderDebateResults(result) : ''}
                </div>
            `;
        }

        function renderDebateResults(result) {
            const sortedCandidates = [...result.candidates].sort((a, b) => b.score - a.score);

            return `
                <div class="mt-8 space-y-4 animate-fade-in">
                    <div class="flex items-center gap-2 text-stat-warning mb-2">
                        ${icons.award}
                        <h3 class="font-bold text-white">Results</h3>
                    </div>

                    ${sortedCandidates.map((cand, idx) => `
                        <div class="bg-stat-card rounded-xl p-4 border border-gray-700 relative overflow-hidden">
                            <div class="flex justify-between items-end mb-2 relative z-10">
                                <div>
                                    <span class="text-3xl font-bold text-white mr-2">#${idx + 1}</span>
                                    <span class="text-xl font-semibold text-gray-200">${cand.name}</span>
                                </div>
                                <div class="text-2xl font-bold text-stat-warning">${cand.score}</div>
                            </div>
                            <p class="text-sm text-gray-400 relative z-10">${cand.reasoning}</p>
                            <!-- Progress Bar Background -->
                            <div
                                class="absolute top-0 left-0 h-full bg-gradient-to-r from-stat-warning to-transparent opacity-10 progress-bar-transition"
                                style="width: ${cand.score}%"
                            ></div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderFantasyView() {
            const { player, context, advice, loading } = state.fantasy;

            return `
                <div class="p-4 pb-24 max-w-lg mx-auto">
                    <h1 class="text-2xl font-bold text-white mb-2 text-center">Fantasy Assistant</h1>
                    <p class="text-gray-400 text-center text-sm mb-6">
                        Make smarter lineup decisions and find hidden waiver gems.
                    </p>

                    <div class="bg-stat-card p-5 rounded-xl border border-gray-700 shadow-lg mb-6">
                        <div class="mb-4">
                            <label class="block text-xs font-bold text-gray-400 uppercase mb-1">Target Player</label>
                            <input
                                type="text"
                                id="fantasy-player"
                                value="${player}"
                                placeholder="e.g. Christian McCaffrey"
                                class="w-full bg-stat-dark border border-gray-600 rounded-lg py-2 px-3 text-white focus:border-stat-success outline-none"
                            />
                        </div>
                        <div class="mb-4">
                            <label class="block text-xs font-bold text-gray-400 uppercase mb-1">Context (League Format)</label>
                            <input
                                type="text"
                                id="fantasy-context"
                                value="${context}"
                                placeholder="e.g. 12 Team PPR, facing top defense"
                                class="w-full bg-stat-dark border border-gray-600 rounded-lg py-2 px-3 text-white focus:border-stat-success outline-none"
                            />
                        </div>
                        <button
                            data-action="fantasy-get-advice"
                            ${loading ? 'disabled' : ''}
                            class="w-full bg-stat-success hover:bg-green-600 text-white font-bold py-3 rounded-lg transition-all shadow-lg shadow-green-900/20 disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            ${loading ? 'Analyzing Matchup...' : 'Get Advice'}
                        </button>
                    </div>

                    ${advice ? renderFantasyAdvice(advice) : ''}
                </div>
            `;
        }

        function renderFantasyAdvice(advice) {
            const statusColor = {
                'START': 'text-stat-success',
                'ADD': 'text-stat-accent',
                'SIT': 'text-stat-danger',
                'DROP': 'text-gray-500'
            }[advice.recommendation] || 'text-white';

            const statusIcon = {
                'START': icons.checkCircle,
                'ADD': icons.plusCircle,
                'SIT': icons.xCircle,
                'DROP': icons.alertTriangle
            }[advice.recommendation] || '';

            const matchupColor = advice.matchupGrade.startsWith('A') ? 'text-green-400' : 'text-yellow-400';

            return `
                <div class="animate-fade-in">
                    <div class="bg-stat-dark border-2 border-gray-700 rounded-2xl p-6 text-center relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-transparent via-white to-transparent opacity-10"></div>

                        <div class="flex justify-center mb-4 ${statusColor}">
                            ${statusIcon}
                        </div>

                        <h2 class="text-gray-400 text-sm font-bold uppercase tracking-widest mb-1">Recommendation</h2>
                        <div class="text-4xl font-black mb-2 ${statusColor}">
                            ${advice.recommendation}
                        </div>

                        <div class="flex justify-center items-center gap-4 mb-6">
                            <div class="bg-gray-800 px-3 py-1 rounded-full text-xs font-mono">
                                Confidence: <span class="text-white">${advice.confidenceScore}%</span>
                            </div>
                            <div class="bg-gray-800 px-3 py-1 rounded-full text-xs font-mono">
                                Matchup: <span class="${matchupColor}">${advice.matchupGrade}</span>
                            </div>
                        </div>

                        <div class="text-left bg-stat-card p-4 rounded-lg border border-gray-700">
                            <h3 class="text-white font-bold text-sm mb-2">Analysis</h3>
                            <p class="text-gray-300 text-sm leading-relaxed">
                                ${advice.reasoning}
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderNavbar() {
            const navItems = [
                { id: 'compare', icon: 'scale', label: 'Compare' },
                { id: 'debate', icon: 'messageSquare', label: 'Debate' },
                { id: 'fantasy', icon: 'activity', label: 'Fantasy' }
            ];

            return `
                <nav class="fixed bottom-0 left-0 right-0 bg-stat-card border-t border-gray-700 pb-safe pt-2 px-4 shadow-lg z-50">
                    <div class="flex justify-around items-center max-w-lg mx-auto h-16">
                        ${navItems.map(item => {
                            const isActive = state.activeTab === item.id;
                            return `
                                <button
                                    data-action="nav-tab" data-tab="${item.id}"
                                    class="flex flex-col items-center justify-center w-full transition-colors duration-200 ${
                                        isActive ? 'text-stat-accent' : 'text-gray-400 hover:text-gray-200'
                                    }"
                                >
                                    <div class="mb-1">${icons[item.icon]}</div>
                                    <span class="text-xs font-medium">${item.label}</span>
                                </button>
                            `;
                        }).join('')}
                    </div>
                </nav>
            `;
        }

        // ============================================
        // EVENT HANDLERS
        // ============================================
        function attachEventListeners() {
            const app = document.getElementById('app');

            // Global keyboard handling for inputs
            app.querySelectorAll('input').forEach(input => {
                input.addEventListener('focus', () => {
                    document.body.classList.add('keyboard-open');
                });
                input.addEventListener('blur', () => {
                    setTimeout(() => {
                        document.body.classList.remove('keyboard-open');
                    }, 100);
                });
            });

            // Navigation
            app.querySelectorAll('[data-action="nav-tab"]').forEach(el => {
                el.addEventListener('click', (e) => {
                    const tab = e.currentTarget.dataset.tab;
                    state.activeTab = tab;
                    render();
                });
            });

            // Compare View - Sport Selection
            app.querySelectorAll('[data-action="select-sport"]').forEach(el => {
                el.addEventListener('click', (e) => {
                    const sport = e.currentTarget.dataset.sport;
                    if (state.compare.sport === sport) return;

                    state.compare.sport = sport;
                    state.compare.p1 = '';
                    state.compare.p2 = '';
                    state.compare.data = null;
                    state.compare.error = '';
                    render();
                });
            });

            // Compare View - Inputs
            const compareP1 = document.getElementById('compare-p1');
            if (compareP1) {
                compareP1.addEventListener('input', (e) => {
                    state.compare.p1 = e.target.value;
                });
            }

            const compareP2 = document.getElementById('compare-p2');
            if (compareP2) {
                compareP2.addEventListener('input', (e) => {
                    state.compare.p2 = e.target.value;
                });
            }

            // Compare View - Fight Button
            app.querySelectorAll('[data-action="compare-fight"]').forEach(el => {
                el.addEventListener('click', handleCompare);
            });

            // Debate View - Inputs
            const debateTopic = document.getElementById('debate-topic');
            if (debateTopic) {
                debateTopic.addEventListener('input', (e) => {
                    state.debate.topic = e.target.value;
                });
            }

            const debateCandidates = document.getElementById('debate-candidates');
            if (debateCandidates) {
                debateCandidates.addEventListener('input', (e) => {
                    state.debate.candidates = e.target.value;
                });
            }

            const debateCriteria = document.getElementById('debate-criteria');
            if (debateCriteria) {
                debateCriteria.addEventListener('input', (e) => {
                    state.debate.criteria = e.target.value;
                });
            }

            // Debate View - Start Button
            app.querySelectorAll('[data-action="debate-start"]').forEach(el => {
                el.addEventListener('click', handleDebate);
            });

            // Fantasy View - Inputs
            const fantasyPlayer = document.getElementById('fantasy-player');
            if (fantasyPlayer) {
                fantasyPlayer.addEventListener('input', (e) => {
                    state.fantasy.player = e.target.value;
                });
            }

            const fantasyContext = document.getElementById('fantasy-context');
            if (fantasyContext) {
                fantasyContext.addEventListener('input', (e) => {
                    state.fantasy.context = e.target.value;
                });
            }

            // Fantasy View - Get Advice Button
            app.querySelectorAll('[data-action="fantasy-get-advice"]').forEach(el => {
                el.addEventListener('click', handleFantasyAdvice);
            });
        }

        // ============================================
        // ACTION HANDLERS
        // ============================================
        function handleCompare() {
            if (!state.compare.p1 || !state.compare.p2) return;

            state.compare.loading = true;
            state.compare.error = '';
            state.compare.data = null;
            render();

            comparePlayers(state.compare.p1, state.compare.p2, state.compare.sport, (result) => {
                state.compare.data = result;
                state.compare.loading = false;
                render();
            });
        }

        function handleDebate() {
            if (!state.debate.topic || !state.debate.candidates) return;

            state.debate.loading = true;
            state.debate.result = null;
            render();

            const candidateList = state.debate.candidates.split(',').map(c => c.trim());
            const criteria = state.debate.criteria || 'General greatness';

            runDebate(state.debate.topic, candidateList, criteria, (result) => {
                state.debate.result = result;
                state.debate.loading = false;
                render();
            });
        }

        function handleFantasyAdvice() {
            if (!state.fantasy.player) return;

            state.fantasy.loading = true;
            render();

            const context = state.fantasy.context || 'Standard PPR League';

            getFantasyAdvice(state.fantasy.player, context, (result) => {
                state.fantasy.advice = result;
                state.fantasy.loading = false;
                render();
            });
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        function initApp() {
            render();
        }

        // Start the app when DOM is ready
        document.addEventListener('DOMContentLoaded', initApp);
    </script>


</body></html>
